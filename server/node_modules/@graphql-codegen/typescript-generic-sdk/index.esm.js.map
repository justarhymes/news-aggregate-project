{"version":3,"file":"index.esm.js","sources":["../../../dist/plugins/typescript/generic-sdk/src/visitor.js","../../../dist/plugins/typescript/generic-sdk/src/index.js"],"sourcesContent":["import { ClientSideBaseVisitor, indentMultiline, DocumentMode, } from '@graphql-codegen/visitor-plugin-common';\nimport autoBind from 'auto-bind';\nimport { Kind } from 'graphql';\nexport class GenericSdkVisitor extends ClientSideBaseVisitor {\n    constructor(schema, fragments, rawConfig) {\n        super(schema, fragments, rawConfig, {});\n        this._operationsToInclude = [];\n        autoBind(this);\n        if (this.config.documentMode !== DocumentMode.string) {\n            this._additionalImports.push(`import { DocumentNode } from 'graphql';`);\n        }\n    }\n    buildOperation(node, documentVariableName, operationType, operationResultType, operationVariablesTypes) {\n        this._operationsToInclude.push({\n            node,\n            documentVariableName,\n            operationType,\n            operationResultType,\n            operationVariablesTypes,\n        });\n        return null;\n    }\n    get sdkContent() {\n        const allPossibleActions = this._operationsToInclude\n            .map(o => {\n            const optionalVariables = !o.node.variableDefinitions ||\n                o.node.variableDefinitions.length === 0 ||\n                o.node.variableDefinitions.every(v => v.type.kind !== Kind.NON_NULL_TYPE || v.defaultValue);\n            return `${o.node.name.value}(variables${optionalVariables ? '?' : ''}: ${o.operationVariablesTypes}, options?: C): Promise<${o.operationResultType}> {\n  return requester<${o.operationResultType}, ${o.operationVariablesTypes}>(${o.documentVariableName}, variables, options);\n}`;\n        })\n            .map(s => indentMultiline(s, 2));\n        return `export type Requester<C= {}> = <R, V>(doc: ${this.config.documentMode === DocumentMode.string ? 'string' : 'DocumentNode'}, vars?: V, options?: C) => Promise<R>\nexport function getSdk<C>(requester: Requester<C>) {\n  return {\n${allPossibleActions.join(',\\n')}\n  };\n}\nexport type Sdk = ReturnType<typeof getSdk>;`;\n    }\n}\n//# sourceMappingURL=visitor.js.map","import { visit, concatAST, Kind } from 'graphql';\nimport { GenericSdkVisitor } from './visitor';\nimport { extname } from 'path';\nexport const plugin = (schema, documents, config) => {\n    const allAst = concatAST(documents.reduce((prev, v) => {\n        return [...prev, v.document];\n    }, []));\n    const allFragments = [\n        ...allAst.definitions.filter(d => d.kind === Kind.FRAGMENT_DEFINITION).map(fragmentDef => ({\n            node: fragmentDef,\n            name: fragmentDef.name.value,\n            onType: fragmentDef.typeCondition.name.value,\n            isExternal: false,\n        })),\n        ...(config.externalFragments || []),\n    ];\n    const visitor = new GenericSdkVisitor(schema, allFragments, config);\n    const visitorResult = visit(allAst, { leave: visitor });\n    return {\n        prepend: visitor.getImports(),\n        content: [\n            visitor.fragments,\n            ...visitorResult.definitions.filter(t => typeof t === 'string'),\n            visitor.sdkContent,\n        ].join('\\n'),\n    };\n};\nexport const validate = async (schema, documents, config, outputFile) => {\n    if (extname(outputFile) !== '.ts') {\n        throw new Error(`Plugin \"typescript-generic-sdk\" requires extension to be \".ts\"!`);\n    }\n};\nexport { GenericSdkVisitor };\n//# sourceMappingURL=index.js.map"],"names":[],"mappings":";;;;;AAGO,MAAM,iBAAiB,SAAS,qBAAqB,CAAC;AAC7D,IAAI,WAAW,CAAC,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE;AAC9C,QAAQ,KAAK,CAAC,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,EAAE,CAAC,CAAC;AAChD,QAAQ,IAAI,CAAC,oBAAoB,GAAG,EAAE,CAAC;AACvC,QAAQ,QAAQ,CAAC,IAAI,CAAC,CAAC;AACvB,QAAQ,IAAI,IAAI,CAAC,MAAM,CAAC,YAAY,KAAK,YAAY,CAAC,MAAM,EAAE;AAC9D,YAAY,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC,uCAAuC,CAAC,CAAC,CAAC;AACpF,SAAS;AACT,KAAK;AACL,IAAI,cAAc,CAAC,IAAI,EAAE,oBAAoB,EAAE,aAAa,EAAE,mBAAmB,EAAE,uBAAuB,EAAE;AAC5G,QAAQ,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC;AACvC,YAAY,IAAI;AAChB,YAAY,oBAAoB;AAChC,YAAY,aAAa;AACzB,YAAY,mBAAmB;AAC/B,YAAY,uBAAuB;AACnC,SAAS,CAAC,CAAC;AACX,QAAQ,OAAO,IAAI,CAAC;AACpB,KAAK;AACL,IAAI,IAAI,UAAU,GAAG;AACrB,QAAQ,MAAM,kBAAkB,GAAG,IAAI,CAAC,oBAAoB;AAC5D,aAAa,GAAG,CAAC,CAAC,IAAI;AACtB,YAAY,MAAM,iBAAiB,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,mBAAmB;AACjE,gBAAgB,CAAC,CAAC,IAAI,CAAC,mBAAmB,CAAC,MAAM,KAAK,CAAC;AACvD,gBAAgB,CAAC,CAAC,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,aAAa,IAAI,CAAC,CAAC,YAAY,CAAC,CAAC;AAC5G,YAAY,OAAO,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,iBAAiB,GAAG,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,uBAAuB,CAAC,wBAAwB,EAAE,CAAC,CAAC,mBAAmB,CAAC;AAC/J,mBAAmB,EAAE,CAAC,CAAC,mBAAmB,CAAC,EAAE,EAAE,CAAC,CAAC,uBAAuB,CAAC,EAAE,EAAE,CAAC,CAAC,oBAAoB,CAAC;AACpG,CAAC,CAAC,CAAC;AACH,SAAS,CAAC;AACV,aAAa,GAAG,CAAC,CAAC,IAAI,eAAe,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AAC7C,QAAQ,OAAO,CAAC,2CAA2C,EAAE,IAAI,CAAC,MAAM,CAAC,YAAY,KAAK,YAAY,CAAC,MAAM,GAAG,QAAQ,GAAG,cAAc,CAAC;AAC1I;AACA;AACA,EAAE,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AACjC;AACA;AACA,4CAA4C,CAAC,CAAC;AAC9C,KAAK;AACL;;ACtCY,MAAC,MAAM,GAAG,CAAC,MAAM,EAAE,SAAS,EAAE,MAAM,KAAK;AACrD,IAAI,MAAM,MAAM,GAAG,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,CAAC,KAAK;AAC3D,QAAQ,OAAO,CAAC,GAAG,IAAI,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC;AACrC,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC;AACZ,IAAI,MAAM,YAAY,GAAG;AACzB,QAAQ,GAAG,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC,mBAAmB,CAAC,CAAC,GAAG,CAAC,WAAW,KAAK;AACnG,YAAY,IAAI,EAAE,WAAW;AAC7B,YAAY,IAAI,EAAE,WAAW,CAAC,IAAI,CAAC,KAAK;AACxC,YAAY,MAAM,EAAE,WAAW,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK;AACxD,YAAY,UAAU,EAAE,KAAK;AAC7B,SAAS,CAAC,CAAC;AACX,QAAQ,IAAI,MAAM,CAAC,iBAAiB,IAAI,EAAE,CAAC;AAC3C,KAAK,CAAC;AACN,IAAI,MAAM,OAAO,GAAG,IAAI,iBAAiB,CAAC,MAAM,EAAE,YAAY,EAAE,MAAM,CAAC,CAAC;AACxE,IAAI,MAAM,aAAa,GAAG,KAAK,CAAC,MAAM,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,CAAC;AAC5D,IAAI,OAAO;AACX,QAAQ,OAAO,EAAE,OAAO,CAAC,UAAU,EAAE;AACrC,QAAQ,OAAO,EAAE;AACjB,YAAY,OAAO,CAAC,SAAS;AAC7B,YAAY,GAAG,aAAa,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,IAAI,OAAO,CAAC,KAAK,QAAQ,CAAC;AAC3E,YAAY,OAAO,CAAC,UAAU;AAC9B,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC;AACpB,KAAK,CAAC;AACN,EAAE;AACU,MAAC,QAAQ,GAAG,OAAO,MAAM,EAAE,SAAS,EAAE,MAAM,EAAE,UAAU,KAAK;AACzE,IAAI,IAAI,OAAO,CAAC,UAAU,CAAC,KAAK,KAAK,EAAE;AACvC,QAAQ,MAAM,IAAI,KAAK,CAAC,CAAC,+DAA+D,CAAC,CAAC,CAAC;AAC3F,KAAK;AACL;;;;"}